<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tr√≤ ch∆°i T√†i X·ªâu</title>
    <style>
        /* CSS gi·ªØ nguy√™n nh∆∞ trong file g·ªëc */
        body {
            font-family: 'Arial', sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #f5f7fa, #c3cfe2);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #333;
        }
        .game-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 600px;
            width: 100%;
        }
        .logout-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background-color: #e74c3c;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .logout-btn:hover {
            background-color: #c0392b;
        }
        body {
            font-family: 'Arial', sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #f5f7fa, #c3cfe2);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #333;
        }
        .game-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 600px;
            width: 100%;
        }
        .logout-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background-color: #e74c3c;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .logout-btn:hover {
            background-color: #c0392b;
        }
        body {
            font-family: 'Arial', sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #f5f7fa, #c3cfe2);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #333;
        }
        .game-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 600px;
            width: 100%;
        }
        h1 {
            font-size: 32px;
            margin-bottom: 20px;
            color: #2c3e50;
        }
        .dice-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            font-size: 80px;
            margin: 20px 0;
        }
        .dice-container div {
            transition: transform 0.3s ease;
        }
        .dice-container div:hover {
            transform: scale(1.1);
        }
        .result {
            font-size: 28px;
            margin-top: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        .circle {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 20px;
            font-weight: bold;
            color: white;
        }
        .xiu {
            background-color: #e74c3c;
        }
        .tai {
            background-color: #2ecc71;
        }
        .history {
            font-size: 24px;
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 5px;
            flex-wrap: wrap;
        }
        .session-info {
            font-size: 18px;
            margin-top: 10px;
            color: #555;
        }
        .bet-container {
            margin-top: 20px;
        }
        .bet-container input {
            padding: 12px;
            font-size: 16px;
            width: 120px;
            margin-right: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            outline: none;
            transition: border-color 0.3s ease;
        }
        .bet-container input:focus {
            border-color: #3498db;
        }
    
        .bet-container button {
            padding: 12px 24px;
            font-size: 16px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .bet-container button:hover {
            background-color: #2980b9;
        }
        .balance {
            font-size: 24px;
            margin-top: 20px;
            color: #2c3e50;
            font-weight: bold;
        }
        .message {
            font-size: 18px;
            margin-top: 10px;
            color: #e74c3c;
            font-weight: bold;
        }
        .win-message {
            color: #2ecc71;
        }
        .deposit-container {
            margin-top: 20px;
        }
        .deposit-container button {
            padding: 12px 24px;
            font-size: 16px;
            background-color: #27ae60;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .deposit-container button:hover {
            background-color: #219653;
        }
        .deposit-info {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
            text-align: left;
        }
        .deposit-info h3 {
            margin-bottom: 10px;
            color: #2c3e50;
        }
        .deposit-info p {
            margin: 5px 0;
            color: #555;
        }
        body {
            font-family: 'Arial', sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #f5f7fa, #c3cfe2);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #333;
        }
        .logout-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background-color: #e74c3c;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .logout-btn:hover {
            background-color: #c0392b;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>üé≤ Tr√≤ ch∆°i T√†i X·ªâu üé≤</h1>
        <div class="session-info" id="session-info">M√£ phi√™n: 1</div>
        <div class="dice-container">
            <div id="dice1">üé≤</div>
            <div id="dice2">üé≤</div>
            <div id="dice3">üé≤</div>
        </div>
        <h2 id="sum">K·∫øt qu·∫£: </h2>
        <div class="result" id="result"></div>
        <div class="history" id="history"></div>

        <div class="bet-container">
            <input type="number" id="bet-amount" placeholder="S·ªë ti·ªÅn c∆∞·ª£c" min="1000" max="50000000">
            <button onclick="placeBet('tai')">ƒê·∫∑t T√†i</button>
            <button onclick="placeBet('xiu')">ƒê·∫∑t X·ªâu</button>
        </div>
        <div class="balance" id="balance">S·ªë d∆∞: 1,000,000 VNƒê</div>
        <div class="message" id="message"></div>

        <!-- Ph·∫ßn n·∫°p ti·ªÅn -->
        <div class="deposit-container">
            <button onclick="showDepositInfo()">N·∫°p ti·ªÅn</button>
        </div>

        <!-- Th√¥ng tin n·∫°p ti·ªÅn -->
        <div class="deposit-info" id="deposit-info">
            <h3>Th√¥ng tin n·∫°p ti·ªÅn</h3>
            <p>T√™n: Tr·∫ßn VƒÉn Hi·∫øu</p>
            <p>Ng√¢n h√†ng: Mbbank/Momo</p>
            <p>S·ªë t√†i kho·∫£n: 0333006835</p>
            <p>Qu√©t m√£ QR ƒë·ªÉ n·∫°p ti·ªÅn:</p>
            <img src="nh.jpg" alt="QR Code" style="width: 300px; height: auto;">
        </div>
    </div>

    <script>
        let historyLog = [];
        let sessionCounter = 1;
        let currentBet = null;
        let betAmount = 0;
        const winMultiplier = 1.9;
        const sessionDuration = 30000; // 60 gi√¢y

        // L·∫•y t√™n ng∆∞·ªùi d√πng hi·ªán t·∫°i t·ª´ localStorage
        let currentUser = localStorage.getItem('currentUser');
        let users = JSON.parse(localStorage.getItem('users')) || {};
        let balance = users[currentUser]?.balance || 1000000;

        // L·∫•y th√¥ng tin phi√™n v√† l·ªãch s·ª≠ t·ª´ localStorage
        let sessionData = JSON.parse(localStorage.getItem('sessionData')) || {
            lastUpdated: new Date().toDateString(),
            sessionCounter: 1,
            historyLog: [],
            sessionStartTime: new Date().getTime() // Th·ªùi gian b·∫Øt ƒë·∫ßu phi√™n hi·ªán t·∫°i
        };

        // Ki·ªÉm tra n·∫øu l√† ng√†y m·ªõi
        if (sessionData.lastUpdated !== new Date().toDateString()) {
            // Ng√†y m·ªõi, kh·ªüi t·∫°o l·∫°i m√£ phi√™n v√† x√≥a l·ªãch s·ª≠
            sessionData = {
                lastUpdated: new Date().toDateString(),
                sessionCounter: 1,
                historyLog: [],
                sessionStartTime: new Date().getTime()
            };
        }

        // C·∫≠p nh·∫≠t bi·∫øn t·ª´ sessionData
        sessionCounter = sessionData.sessionCounter;
        historyLog = sessionData.historyLog;

        // T√≠nh th·ªùi gian c√≤n l·∫°i cho phi√™n ti·∫øp theo
        let currentTime = new Date().getTime();
        let sessionStartTime = sessionData.sessionStartTime;
        let timeRemaining = sessionDuration - (currentTime - sessionStartTime);

        // N·∫øu th·ªùi gian c√≤n l·∫°i <= 0, c·∫≠p nh·∫≠t phi√™n m·ªõi
        if (timeRemaining <= 0) {
            sessionData.sessionCounter++;
            sessionData.sessionStartTime = currentTime;
            timeRemaining = sessionDuration;
        }

        // L∆∞u th√¥ng tin phi√™n v√† l·ªãch s·ª≠ v√†o localStorage
        localStorage.setItem('sessionData', JSON.stringify(sessionData));

        function updateBalance() {
            document.getElementById("balance").textContent = "S·ªë d∆∞: " + balance.toLocaleString() + " VNƒê";
            users[currentUser].balance = balance;
            localStorage.setItem('users', JSON.stringify(users));
        }

        function rollDice() {
            return Math.floor(Math.random() * 6) + 1;
        }

        function getDiceEmoji(value) {
            const diceFaces = ["", "‚öÄ", "‚öÅ", "‚öÇ", "‚öÉ", "‚öÑ", "‚öÖ"];
            return diceFaces[value];
        }

        function updateDice() {
            let d1 = rollDice();
            let d2 = rollDice();
            let d3 = rollDice();
            let sum = d1 + d2 + d3;

            document.getElementById("dice1").textContent = getDiceEmoji(d1);
            document.getElementById("dice2").textContent = getDiceEmoji(d2);
            document.getElementById("dice3").textContent = getDiceEmoji(d3);
            document.getElementById("sum").textContent = "K·∫øt qu·∫£: " + sum;

            let resultDiv = document.getElementById("result");
            let historyDiv = document.getElementById("history");
            let resultText = "";
            let circleElement = "";

            if (sum < 11) {
                resultText = "X·ªâu <span class='circle xiu'>X</span>";
                circleElement = "<span class='circle xiu'>X</span>";
            } else {
                resultText = "T√†i <span class='circle tai'>T</span>";
                circleElement = "<span class='circle tai'>T</span>";
            }

            resultDiv.innerHTML = resultText;
            historyLog.push(circleElement);

            if (historyLog.length > 11) {
                historyLog.shift();
            }

            historyDiv.innerHTML = "L·ªãch s·ª≠: " + historyLog.join(" ");

            document.getElementById("session-info").textContent = "M√£ phi√™n: " + sessionCounter;

            // L∆∞u th√¥ng tin phi√™n v√† l·ªãch s·ª≠ v√†o localStorage
            sessionData.sessionCounter = sessionCounter;
            sessionData.historyLog = historyLog;
            sessionData.sessionStartTime = new Date().getTime();
            localStorage.setItem('sessionData', JSON.stringify(sessionData));

            if (currentBet) {
                let isWin = (currentBet === "tai" && sum >= 11) || (currentBet === "xiu" && sum < 11);
                if (isWin) {
                    let winAmount = betAmount * winMultiplier;
                    balance += winAmount;
                    document.getElementById("message").textContent = "B·∫°n ƒë√£ th·∫Øng: " + winAmount.toLocaleString() + " VNƒê!";
                    document.getElementById("message").classList.add("win-message");
                } else {
                    balance -= betAmount;
                    document.getElementById("message").textContent = "B·∫°n ƒë√£ thua: " + betAmount.toLocaleString() + " VNƒê!";
                    document.getElementById("message").classList.remove("win-message");
                }
                currentBet = null;
                updateBalance();
            }
        }

        function placeBet(betType) {
            let amount = parseInt(document.getElementById("bet-amount").value);
            if (isNaN(amount) || amount < 1000 || amount > 50000000) {
                document.getElementById("message").textContent = "S·ªë ti·ªÅn c∆∞·ª£c kh√¥ng h·ª£p l·ªá (1,000 - 50,000,000 VNƒê)!";
                return;
            }
            if (currentBet === betType) {
                if (betAmount + amount > balance) {
                    document.getElementById("message").textContent = "S·ªë d∆∞ kh√¥ng ƒë·ªß ƒë·ªÉ ƒë·∫∑t c∆∞·ª£c!";
                    return;
                }
                betAmount += amount; // C·ªông d·ªìn s·ªë ti·ªÅn c∆∞·ª£c
            } else {
                if (amount > balance) {
                    document.getElementById("message").textContent = "S·ªë d∆∞ kh√¥ng ƒë·ªß ƒë·ªÉ ƒë·∫∑t c∆∞·ª£c!";
                    return;
                }
                if (betAmount + amount > balance) {
                    document.getElementById("message").textContent = "S·ªë d∆∞ kh√¥ng ƒë·ªß ƒë·ªÉ ƒë·∫∑t c∆∞·ª£c!";
                    return;
                }
                if (currentBet && currentBet !== betType) {
                    document.getElementById("message").textContent = "B·∫°n kh√¥ng th·ªÉ ƒë·∫∑t c∆∞·ª£c c·∫£ T√†i v√† X·ªâu!";
                    return;
                }
                currentBet = betType;
                betAmount = amount;
            }
            document.getElementById("message").textContent = "B·∫°n ƒë√£ ƒë·∫∑t c∆∞·ª£c " + betType.toUpperCase() + " v·ªõi t·ªïng s·ªë ti·ªÅn " + betAmount.toLocaleString() + " VNƒê!";
        }

        function showDepositInfo() {
            const depositInfo = document.getElementById("deposit-info");
            depositInfo.style.display = "block";
        }

        // Hi·ªÉn th·ªã l·ªãch s·ª≠ v√† m√£ phi√™n khi trang ƒë∆∞·ª£c load
        document.getElementById("history").innerHTML = "L·ªãch s·ª≠: " + historyLog.join(" ");
        document.getElementById("session-info").textContent = "M√£ phi√™n: " + sessionCounter;

        // C·∫≠p nh·∫≠t phi√™n ti·∫øp theo sau khi th·ªùi gian ƒë·ªß
        setTimeout(() => {
            updateDice();
            setInterval(updateDice, sessionDuration);
        }, timeRemaining);

        updateBalance();
    </script>
    <button class="logout-btn" onclick="logout()">ƒêƒÉng xu·∫•t</button>

    <script>
        function logout() {
            localStorage.removeItem('currentUser'); // X√≥a ng∆∞·ªùi d√πng hi·ªán t·∫°i
            window.location.href = "index.html"; // Chuy·ªÉn h∆∞·ªõng v·ªÅ trang ƒëƒÉng nh·∫≠p
        }
    </script>
</body>
</html>